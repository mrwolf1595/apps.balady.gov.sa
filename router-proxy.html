<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="icon" type="image/x-icon" href="https://apps.balady.gov.sa/BALADYCDN/Content/images/fav.ico">
</head>
<body>
<div id="debug-info" style="background: #000; color: #0f0; padding: 20px; font-family: monospace; white-space: pre-wrap;"></div>

<script>
(function() {
    const debugDiv = document.getElementById('debug-info');
    
    function log(msg) {
        console.log(msg);
        debugDiv.innerHTML += msg + '\n';
    }
    
    // قراءة الـ URL بكل الطرق الممكنة
    const fullURL = window.location.href;
    const params = new URLSearchParams(window.location.search);
    const path = window.location.pathname;
    
    log('=== DEBUG INFO ===');
    log('Full URL: ' + fullURL);
    log('Path: ' + path);
    log('Search: ' + window.location.search);
    log('Hash: ' + window.location.hash);
    
    // جلب الـ key من الـ URL
    let key = params.get('key');
    log('Key from search params: ' + key);
    
    // إذا مافيش key في الـ search params، جرب تجيبه من الـ URL نفسه
    if (!key) {
        const keyMatch = fullURL.match(/[?&]key=([^&]+)/);
        if (keyMatch) {
            key = keyMatch[1];
            log('Key from URL regex: ' + key);
        }
    }
    
    // جدول التوجيه
    const routes = {
        '7e46a31919881b2bf3e5d5ca6f600000': '/index1.html',
        '5047665a19881b2a74ff415dd6c00000': '/index.html'
    };
    
    log('Available routes: ' + JSON.stringify(routes, null, 2));
    
    // تحديد الملف المطلوب
    let targetFile = '/index.html'; // default
    
    if (key && routes[key]) {
        targetFile = routes[key];
        log('✓ Target file selected: ' + targetFile);
    } else {
        log('✗ Using default file: ' + targetFile);
        log('✗ Key "' + key + '" not found in routes');
    }
    
    log('=== LOADING ' + targetFile + ' ===');
    
    // انتظار 3 ثواني عشان تقرأ الـ debug info
    setTimeout(() => {
        fetch(targetFile)
            .then(r => {
                log('HTTP Status: ' + r.status);
                if (!r.ok) {
                    throw new Error(`HTTP ${r.status}`);
                }
                return r.text();
            })
            .then(html => {
                log('✓ File loaded successfully, replacing content...');
                document.open();
                document.write(html);
                document.close();
            })
            .catch(error => {
                log('✗ Error loading file: ' + error.message);
                debugDiv.innerHTML += '\n<h3 style="color: red;">ERROR: Could not load ' + targetFile + '</h3>';
                debugDiv.innerHTML += '<p>Error: ' + error.message + '</p>';
                debugDiv.innerHTML += '<p>Available files to check:</p>';
                debugDiv.innerHTML += '<ul><li>/index.html</li><li>/index1.html</li></ul>';
            });
    }, 3000);
})();
</script>
</body>
</html>